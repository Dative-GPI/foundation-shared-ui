var O=Object.defineProperty;var k=(i,t,o)=>t in i?O(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o;var e=(i,t,o)=>k(i,typeof t!="symbol"?t+"":t,o);import"./vue.esm-bundler-D5n7z5qz.js";import{H as I,U as p,S as m,a as N}from"./hubFactory-B0gUdtus.js";import{C as R,H as w}from"./base-YMsHX0Is.js";import{D as y}from"./deviceConnectivityDetails-DsuFztYx.js";import{C as c}from"./composableFactory-zc0ZsFxC.js";import{S as r}from"./serviceFactory-CyDQptGk.js";import{i as l}from"./datesTools-DpylUQoJ.js";import{P as C}from"./pathCrumb-Db-cq5HI.js";import{S as V}from"./subgroupingInfos-CBtJpNmo.js";import{A as G}from"./address-CE2z3AEI.js";class f{constructor(t){e(this,"id");e(this,"label");e(this,"status");e(this,"criticity");e(this,"sourceTimestamp");e(this,"enqueuedTimestamp");e(this,"actualTimestamp");this.id=t.id,this.label=t.label,this.status=t.status,this.criticity=t.criticity,this.sourceTimestamp=t.sourceTimestamp?l(t.sourceTimestamp):void 0,this.enqueuedTimestamp=t.enqueuedTimestamp?l(t.enqueuedTimestamp):void 0,this.actualTimestamp=l(t.actualTimestamp)}}class B{constructor(t){e(this,"id");e(this,"statuses");this.id=t.id,this.statuses=t.statuses.map(o=>new x(o))}}class x{constructor(t){e(this,"modelStatusId");e(this,"statusGroups");this.modelStatusId=t.modelStatusId,this.statusGroups=t.statusGroups.map(o=>new $(o))}}class ${constructor(t){e(this,"sourceTimestamp");e(this,"enqueuedTimestamp");e(this,"processedTimestamp");e(this,"groupByValue");e(this,"value");e(this,"unit");e(this,"label");e(this,"icon");e(this,"color");this.sourceTimestamp=t.sourceTimestamp?l(t.sourceTimestamp):null,this.enqueuedTimestamp=t.enqueuedTimestamp?l(t.enqueuedTimestamp):null,this.processedTimestamp=t.processedTimestamp?l(t.processedTimestamp):null,this.groupByValue=t.groupByValue,this.value=t.value,this.unit=t.unit,this.label=t.label,this.icon=t.icon,this.color=t.color}}class D extends B{constructor(t){super(t)}}class q{constructor(t){e(this,"id");e(this,"modelId");e(this,"dataCategoryId");e(this,"dataCategoryLabel");e(this,"dataDefinitionId");e(this,"dataDefinitionLabel");e(this,"groupById");e(this,"groupByLabel");e(this,"label");e(this,"index");e(this,"lifetime");e(this,"timeToLive");e(this,"showDefault");e(this,"iconDefault");e(this,"colorDefault");this.id=t.id,this.modelId=t.modelId,this.dataCategoryId=t.dataCategoryId,this.dataCategoryLabel=t.dataCategoryLabel,this.dataDefinitionId=t.dataDefinitionId,this.dataDefinitionLabel=t.dataDefinitionLabel,this.groupById=t.groupById,this.groupByLabel=t.groupByLabel,this.label=t.label,this.index=t.index,this.lifetime=t.lifetime,this.timeToLive=t.timeToLive,this.showDefault=t.showDefault,this.iconDefault=t.iconDefault,this.colorDefault=t.colorDefault}}class S{constructor(t){e(this,"id");e(this,"deviceId");e(this,"manufacturerId");e(this,"manufacturerLabel");e(this,"latitude");e(this,"longitude");e(this,"articleId");e(this,"articleLabel");e(this,"articleCode");e(this,"modelId");e(this,"modelLabel");e(this,"ownerId");e(this,"ownerLabel");e(this,"ownerAddress");e(this,"organisationId");e(this,"managerId");e(this,"managerName");e(this,"locationId");e(this,"locationLabel");e(this,"locationAddress");e(this,"locationLatitude");e(this,"locationLongitude");e(this,"groupId");e(this,"groupLabel");e(this,"groupIcon");e(this,"label");e(this,"code");e(this,"description");e(this,"imageId");e(this,"tags");e(this,"unrestricted");e(this,"online");e(this,"path");e(this,"meta");e(this,"modelStatuses");e(this,"status");e(this,"connectivity");e(this,"alerts");e(this,"worstAlert");e(this,"subgroupings");this.id=t.id,this.deviceId=t.deviceId,this.manufacturerId=t.manufacturerId,this.manufacturerLabel=t.manufacturerLabel,this.latitude=t.latitude,this.longitude=t.longitude,this.articleId=t.articleId,this.articleLabel=t.articleLabel,this.articleCode=t.articleCode,this.modelId=t.modelId,this.modelLabel=t.modelLabel,this.ownerId=t.ownerId,this.ownerLabel=t.ownerLabel,this.ownerAddress=t.ownerAddress?new G(t.ownerAddress):null,this.organisationId=t.organisationId,this.managerId=t.managerId,this.managerName=t.managerName,this.locationId=t.locationId,this.locationLabel=t.locationLabel,this.locationAddress=t.locationAddress,this.locationLatitude=t.locationLatitude,this.locationLongitude=t.locationLongitude,this.groupId=t.groupId,this.groupLabel=t.groupLabel,this.groupIcon=t.groupIcon,this.label=t.label,this.code=t.code,this.description=t.description,this.imageId=t.imageId,this.tags=t.tags.slice(),this.unrestricted=t.unrestricted,this.online=t.online,this.path=t.path.map(o=>new C({...o})).sort((o,s)=>s.index-o.index),this.meta={...t.meta},this.modelStatuses=t.modelStatuses.map(o=>new q(o)),this.status=new D(t.status),this.connectivity=new y(t.connectivity),this.alerts=t.alerts.map(o=>new f(o)),this.worstAlert=t.worstAlert!=null?new f(t.worstAlert):null,this.subgroupings=t.subgroupings.map(o=>new V(o))}}class H{constructor(t){e(this,"id");e(this,"key");e(this,"value");e(this,"keyLabel");e(this,"valueLabel");this.id=t.id,this.key=t.key,this.value=t.value,this.keyLabel=t.keyLabel,this.valueLabel=t.valueLabel}}class g extends S{constructor(o){super(o);e(this,"familyId");e(this,"familyLabel");e(this,"options");e(this,"path");this.familyId=o.familyId,this.familyLabel=o.familyLabel,this.options=o.options.map(s=>new H({...s})),this.path=o.path.map(s=>new C({...s})).sort((s,n)=>n.index-s.index)}}const b=()=>`${R()}/device-organisations`,d=i=>`${b()}/${encodeURIComponent(i)}`,F=i=>`${d(i)}/group`,M=i=>`${d(i)}/location`,P=i=>`${d(i)}/connectivity`,W=()=>`${w()}/connectivities`,Y=i=>`${d(i)}/status`,j=()=>`${w()}/statuses`,L=new r("deviceConnectivity",y).create(i=>i.build(i.addGet(P),i.addNotify(t=>({notifyUpdate:o=>t.notify("update",o)})))),z=I.create(W,i=>{i.on(p,t=>L.notifyUpdate(new y(t)))},async i=>{await i.invoke(m)});c.get(L);const E=c.track(L),A=I.createWatcher(z),T=new r("deviceStatus",D).create(i=>i.build(i.addGet(Y),i.addNotify(t=>({notifyUpdate:o=>t.notify("update",o)})))),J=I.create(j,i=>{i.on(N,t=>T.notifyUpdate(new D(t)))},async i=>{await i.invoke(m)});c.get(T);const U=c.track(T),_=I.createWatcher(J),a=new r("deviceOrganisation",g).create(i=>i.build(i.addGet(d),i.addGetMany(b,S),i.addCreate(b),i.addUpdate(d),i.addRemove(d),i.addNotify(t=>({...r.addCustom("changeGroup",(o,s,n)=>o.put(F(s),n),o=>{const s=new g(o);return t.notify("update",s),s}),...r.addCustom("changeLocation",(o,s,n)=>o.put(M(s),n),o=>{const s=new g(o);return t.notify("update",s),s}),notifyReset:()=>t.notify("reset")})))),h=()=>{const{track:i}=U(),{track:t}=E(),{watchOne:o}=_(),{watchOne:s}=A();return n=>{o(n.value.status.id),s(n.value.connectivity.id),i(n.value.status,u=>n.value.status=u),t(n.value.connectivity,u=>n.value.connectivity=u)}},K=()=>{const{track:i}=U(),{track:t}=E(),{watchMany:o}=_(),{watchMany:s}=A();return n=>{o(),s();for(const u of n.value)i(u.status,v=>u.status=v),t(u.connectivity,v=>u.connectivity=v)}},ut=c.subscribe(a);a.notifyReset;const dt=c.get(a,h),lt=c.getMany(a,K);c.create(a,h);c.update(a,h);c.remove(a);c.custom(a.changeGroup,h);c.custom(a.changeLocation,h);export{D,q as M,dt as a,f as b,A as c,_ as d,E as e,U as f,ut as g,lt as u};
