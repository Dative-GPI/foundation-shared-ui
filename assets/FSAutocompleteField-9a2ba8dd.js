import{j as Be,d as E,e as g,w as j,s as L,n as ie,v as n,F as z,x as P,U as K,I as de,J as C,K as $,L as w,R as U,M as Z,V as oe,N as O,Q as Oe,_ as Me,Y as Le,W as Ue,X as Ne}from"./vue.esm-bundler-b2d5d1a7.js";import{_ as ne}from"./FSButton-c6abd92f.js";import{_ as H}from"./FSSpan-2ee73edb.js";import{_ as ve}from"./FSCol-8af42802.js";import{_ as ye}from"./FSRow-ad0fe7ea.js";import{F as Ee}from"./FSLoader-d736f414.js";import{F as je}from"./FSToggleSet-d64083d4.js";import{u as Ke}from"./useRules-999feed4.js";import{u as He,C as N}from"./useColors-1799ca43.js";import{u as ze}from"./useSlots-0e4d21ee.js";import{_ as We}from"./_plugin-vue_export-helper-c27b6911.js";import{V as Je}from"./VSpacer-73e95d50.js";import{m as Qe,u as Xe,a as Ye,b as Ge,c as fe,d as Ze,e as _e,f as xe}from"./VSelect-13b35610.js";import{m as el,V as ce}from"./VTextField-6a1548fe.js";import{a as ll}from"./color-1b074b3b.js";import{m as al,u as tl}from"./filter-dab5f9d0.js";import{b as ol}from"./VInput-16b8deac.js";import{f as ul}from"./forwardRefs-e658ad70.js";import{u as nl}from"./locale-602cc07b.js";import{u as ue}from"./proxiedModel-92ce7dab.js";import{m as sl}from"./transition-42bdb3ea.js";import{V as rl}from"./VMenu-03edebad.js";import{V as il}from"./VCheckboxBtn-87c4493b.js";import{V as me}from"./VIcon-18e13c83.js";import{V as dl}from"./VDefaultsProvider-37d19a63.js";import{p as fl,o as cl,I as ml,M as pl,N as vl,w as yl,O as pe}from"./theme-66179376.js";import{g as gl,u as Vl}from"./useRender-3dd3f3c7.js";const ge=Be({name:"FSAutocompleteField",components:{FSToggleSet:je,FSButton:ne,FSLoader:Ee,FSSpan:H,FSCol:ve,FSRow:ye},props:{label:{type:String,required:!1,default:null},description:{type:String,required:!1,default:null},items:{type:Array,required:!0},itemValue:{type:String,required:!1,default:"id"},itemTitle:{type:String,required:!1,default:"label"},modelValue:{type:[Array,String],required:!1,default:null},multiple:{type:Boolean,required:!1,default:!1},hideHeader:{type:Boolean,required:!1,default:!1},returnObject:{type:Boolean,required:!1,default:!1},required:{type:Boolean,required:!1,default:!1},rules:{type:Array,required:!1,default:()=>[]},messages:{type:Array,required:!1,default:null},editable:{type:Boolean,required:!1,default:!0},loading:{type:Boolean,required:!1,default:!1},toggleSet:{type:Boolean,required:!1,default:!1}},emits:["update:modelValue","update:search"],setup:(e,{emit:f})=>{const{validateOn:a,blurred:R,getMessages:V}=Ke(),{getColors:p}=He(),{slots:v}=ze();delete v.label,delete v.description;const q=p(N.Background),S=p(N.Error),k=p(N.Light),A=p(N.Dark),s=E(""),r=g(()=>e.editable?{"--fs-autocomplete-field-cursor":"text","--fs-autocomplete-field-background-color":q.base,"--fs-autocomplete-field-border-color":k.dark,"--fs-autocomplete-field-color":A.base,"--fs-autocomplete-field-active-border-color":A.dark,"--fs-autocomplete-field-error-color":S.base,"--fs-autocomplete-field-error-border-color":S.base}:{"--fs-autocomplete-field-cursor":"default","--fs-autocomplete-field-border-color":k.base,"--fs-autocomplete-field-color":k.dark,"--fs-autocomplete-field-active-border-color":k.base}),_=g(()=>({style:r.value})),W=g(()=>{const T=["fs-autocomplete-field"];return e.multiple&&T.push("fs-autocomplete-multiple-field"),T}),J=g(()=>e.messages??V(e.modelValue,e.rules)),x=T=>{f("update:modelValue",T)};return j(s,()=>{f("update:search",s.value)}),{innerSearch:s,validateOn:a,ColorEnum:N,listStyle:_,messages:J,blurred:R,classes:W,slots:v,style:r,onUpdate:x}}});function hl(e,f,a){if(f==null)return e;if(Array.isArray(f))throw new Error("Multiple matches is not implemented");return typeof f=="number"&&~f?n(z,null,[n("span",{class:"v-autocomplete__unmask"},[e.substr(0,f)]),n("span",{class:"v-autocomplete__mask"},[e.substr(f,a)]),n("span",{class:"v-autocomplete__unmask"},[e.substr(f+a)])]):e}const bl=fl({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:Boolean,search:String,...al({filterKeys:["title"]}),...Qe(),...cl(el({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...sl({transition:!1})},"VAutocomplete"),Sl=gl()({name:"VAutocomplete",props:bl(),emits:{"update:focused":e=>!0,"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,f){let{slots:a}=f;const{t:R}=nl(),V=E(),p=L(!1),v=L(!0),q=L(!1),S=E(),k=E(),A=ue(e,"menu"),s=g({get:()=>A.value,set:l=>{var t;A.value&&!l&&((t=S.value)!=null&&t.Î¨openChildren)||(A.value=l)}}),r=L(-1),_=g(()=>{var l;return(l=V.value)==null?void 0:l.color}),W=g(()=>s.value?e.closeText:e.openText),{items:J,transformIn:x,transformOut:T}=Xe(e),{textColorClasses:Ve,textColorStyles:he}=ll(_),c=ue(e,"search",""),u=ue(e,"modelValue",[],l=>x(l===null?[null]:yl(l)),l=>{const t=T(l);return e.multiple?t:t[0]??null}),be=g(()=>typeof e.counterValue=="function"?e.counterValue(u.value):typeof e.counterValue=="number"?e.counterValue:u.value.length),B=ol(),{filteredItems:ee,getMatches:Se}=tl(e,J,()=>v.value?"":c.value),F=g(()=>e.hideSelected?ee.value.filter(l=>!u.value.some(t=>t.value===l.value)):ee.value),Q=g(()=>!!(e.chips||a.chip)),M=g(()=>Q.value||!!a.selection),ke=g(()=>u.value.map(l=>l.props.value)),X=g(()=>{var t;return(e.autoSelectFirst===!0||e.autoSelectFirst==="exact"&&c.value===((t=F.value[0])==null?void 0:t.title))&&F.value.length>0&&!v.value&&!q.value}),le=g(()=>e.hideNoData&&!F.value.length||e.readonly||(B==null?void 0:B.isReadonly.value)),ae=E(),{onListScroll:Fe,onListKeydown:Ce}=Ye(ae,V);function $e(l){e.openOnClear&&(s.value=!0),c.value=""}function we(){le.value||(s.value=!0)}function qe(l){le.value||(p.value&&(l.preventDefault(),l.stopPropagation()),s.value=!s.value)}function Ae(l){var o,i,h;if(e.readonly||B!=null&&B.isReadonly.value)return;const t=V.value.selectionStart,d=u.value.length;if((r.value>-1||["Enter","ArrowDown","ArrowUp"].includes(l.key))&&l.preventDefault(),["Enter","ArrowDown"].includes(l.key)&&(s.value=!0),["Escape"].includes(l.key)&&(s.value=!1),X.value&&["Enter","Tab"].includes(l.key)&&I(F.value[0]),l.key==="ArrowDown"&&X.value&&((o=ae.value)==null||o.focus("next")),["Backspace","Delete"].includes(l.key)){if(!e.multiple&&M.value&&u.value.length>0&&!c.value)return I(u.value[0],!1);if(~r.value){const m=r.value;I(u.value[r.value],!1),r.value=m>=d-1?d-2:m}else l.key==="Backspace"&&!c.value&&(r.value=d-1)}if(e.multiple){if(l.key==="ArrowLeft"){if(r.value<0&&t>0)return;const m=r.value>-1?r.value-1:d-1;u.value[m]?r.value=m:(r.value=-1,V.value.setSelectionRange((i=c.value)==null?void 0:i.length,(h=c.value)==null?void 0:h.length))}if(l.key==="ArrowRight"){if(r.value<0)return;const m=r.value+1;u.value[m]?r.value=m:(r.value=-1,V.value.setSelectionRange(0,0))}}}function Ie(l){if(pe(V.value,":autofill")||pe(V.value,":-webkit-autofill")){const t=J.value.find(d=>d.title===l.target.value);t&&I(t)}}function Pe(){var l;p.value&&(v.value=!0,(l=V.value)==null||l.focus())}function De(l){p.value=!0,setTimeout(()=>{q.value=!0})}function Re(l){q.value=!1}function Te(l){(l==null||l===""&&!e.multiple&&!M.value)&&(u.value=[])}const te=L(!1);function I(l){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!l||l.props.disabled))if(e.multiple){const d=u.value.findIndex(i=>e.valueComparator(i.value,l.value)),o=t??!~d;if(~d){const i=o?[...u.value,l]:[...u.value];i.splice(d,1),u.value=i}else o&&(u.value=[...u.value,l]);e.clearOnSelect&&(c.value="")}else{const d=t!==!1;u.value=d?[l]:[],c.value=d&&!M.value?l.title:"",ie(()=>{s.value=!1,v.value=!0})}}return j(p,(l,t)=>{var d;l!==t&&(l?(te.value=!0,c.value=e.multiple||M.value?"":String(((d=u.value.at(-1))==null?void 0:d.props.title)??""),v.value=!0,ie(()=>te.value=!1)):(!e.multiple&&c.value==null?u.value=[]:X.value&&!q.value&&!u.value.some(o=>{let{value:i}=o;return i===F.value[0].value})&&I(F.value[0]),s.value=!1,c.value="",r.value=-1))}),j(c,l=>{!p.value||te.value||(l&&(s.value=!0),v.value=!l)}),j(s,()=>{if(!e.hideSelected&&s.value&&u.value.length){const l=F.value.findIndex(t=>u.value.some(d=>t.value===d.value));ml&&window.requestAnimationFrame(()=>{var t;l>=0&&((t=k.value)==null||t.scrollToIndex(l))})}}),j(()=>e.items,(l,t)=>{s.value||p.value&&!t.length&&l.length&&(s.value=!0)}),Vl(()=>{const l=!!(!e.hideNoData||F.value.length||a["prepend-item"]||a["append-item"]||a["no-data"]),t=u.value.length>0,d=ce.filterProps(e);return n(ce,P({ref:V},d,{modelValue:c.value,"onUpdate:modelValue":[o=>c.value=o,Te],focused:p.value,"onUpdate:focused":o=>p.value=o,validationValue:u.externalValue,counterValue:be.value,dirty:t,onChange:Ie,class:["v-autocomplete",`v-autocomplete--${e.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":s.value,"v-autocomplete--chips":!!e.chips,"v-autocomplete--selection-slot":!!M.value,"v-autocomplete--selecting-index":r.value>-1},e.class],style:e.style,readonly:e.readonly,placeholder:t?void 0:e.placeholder,"onClick:clear":$e,"onMousedown:control":we,onKeydown:Ae}),{...a,default:()=>n(z,null,[n(rl,P({ref:S,modelValue:s.value,"onUpdate:modelValue":o=>s.value=o,activator:"parent",contentClass:"v-autocomplete__content",disabled:le.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:Pe},e.menuProps),{default:()=>[l&&n(Ge,P({ref:ae,selected:ke.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:o=>o.preventDefault(),onKeydown:Ce,onFocusin:De,onFocusout:Re,onScrollPassive:Fe,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},e.listProps),{default:()=>{var o,i,h;return[(o=a["prepend-item"])==null?void 0:o.call(a),!F.value.length&&!e.hideNoData&&(((i=a["no-data"])==null?void 0:i.call(a))??n(fe,{title:R(e.noDataText)},null)),n(Ze,{ref:k,renderless:!0,items:F.value},{default:m=>{var re;let{item:y,index:D,itemRef:b}=m;const se=P(y.props,{ref:b,key:D,active:X.value&&D===0?!0:void 0,onClick:()=>I(y,null)});return((re=a.item)==null?void 0:re.call(a,{item:y,index:D,props:se}))??n(fe,P(se,{role:"option"}),{prepend:Y=>{let{isSelected:G}=Y;return n(z,null,[e.multiple&&!e.hideSelected?n(il,{key:y.value,modelValue:G,ripple:!1,tabindex:"-1"},null):void 0,y.props.prependAvatar&&n(_e,{image:y.props.prependAvatar},null),y.props.prependIcon&&n(me,{icon:y.props.prependIcon},null)])},title:()=>{var Y,G;return v.value?y.title:hl(y.title,(Y=Se(y))==null?void 0:Y.title,((G=c.value)==null?void 0:G.length)??0)}})}}),(h=a["append-item"])==null?void 0:h.call(a)]}})]}),u.value.map((o,i)=>{function h(b){b.stopPropagation(),b.preventDefault(),I(o,!1)}const m={"onClick:close":h,onKeydown(b){b.key!=="Enter"&&b.key!==" "||(b.preventDefault(),b.stopPropagation(),h(b))},onMousedown(b){b.preventDefault(),b.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},y=Q.value?!!a.chip:!!a.selection,D=y?pl(Q.value?a.chip({item:o,index:i,props:m}):a.selection({item:o,index:i})):void 0;if(!(y&&!D))return n("div",{key:o.value,class:["v-autocomplete__selection",i===r.value&&["v-autocomplete__selection--selected",Ve.value]],style:i===r.value?he.value:{}},[Q.value?a.chip?n(dl,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:o.title}}},{default:()=>[D]}):n(xe,P({key:"chip",closable:e.closableChips,size:"small",text:o.title,disabled:o.props.disabled},m),null):D??n("span",{class:"v-autocomplete__selection-text"},[o.title,e.multiple&&i<u.value.length-1&&n("span",{class:"v-autocomplete__selection-comma"},[K(",")])])])})]),"append-inner":function(){var m;for(var o=arguments.length,i=new Array(o),h=0;h<o;h++)i[h]=arguments[h];return n(z,null,[(m=a["append-inner"])==null?void 0:m.call(a,...i),e.menuIcon?n(me,{class:"v-autocomplete__menu-icon",icon:e.menuIcon,onMousedown:qe,onClick:vl,"aria-label":R(W.value),title:R(W.value)},null):void 0])}})}),ul({isFocused:p,isPristine:v,menu:s,search:c,filteredItems:ee,select:I},V)}});function kl(e,f,a,R,V,p){const v=de("FSLoader"),q=de("FSToggleSet");return C(),$(ve,null,{default:w(()=>[e.$props.hideHeader?O("",!0):U(e.$slots,"label",{key:0},()=>[n(ye,{wrap:!1},{default:w(()=>[e.$props.label?(C(),$(H,{key:0,class:"fs-autocomplete-field-label",font:"text-overline",style:Z(e.style)},{default:w(()=>[K(oe(e.$props.label),1)]),_:1},8,["style"])):O("",!0),e.$props.label&&e.$props.required?(C(),$(H,{key:1,class:"fs-autocomplete-field-label",style:Z([{"margin-left":"-8px"},e.style]),font:"text-overline",ellipsis:!1},{default:w(()=>[K(" * ")]),_:1},8,["style"])):O("",!0),n(Je,{style:{"min-width":"40px"}}),e.messages.length>0?(C(),$(H,{key:2,class:"fs-autocomplete-field-messages",font:"text-overline",style:Z(e.style)},{default:w(()=>[K(oe(e.messages.join(", ")),1)]),_:1},8,["style"])):O("",!0)]),_:1})]),e.$props.loading?(C(),$(v,{key:1,width:"100%",height:["40px","36px"]})):(C(),Oe(z,{key:2},[e.$props.toggleSet?(C(),$(q,P({key:0,variant:"slide",multiple:e.$props.multiple,values:e.$props.items,rules:e.$props.rules,modelValue:e.$props.modelValue,"onUpdate:modelValue":e.onUpdate},e.$attrs),null,16,["multiple","values","rules","modelValue","onUpdate:modelValue"])):(C(),$(Sl,P({key:1,class:["fs-autocomplete-field",e.classes],variant:"outlined",menuIcon:null,style:e.style,listProps:e.listStyle,hideDetails:!0,items:e.$props.items,autoSelectFirst:!0,multiple:e.$props.multiple,itemTitle:e.$props.itemTitle,itemValue:e.$props.itemValue,readonly:!e.$props.editable,loading:e.$props.loading,clearable:e.$props.editable&&!!e.$props.modelValue,returnObject:e.$props.returnObject,rules:e.$props.rules,validateOn:e.validateOn,modelValue:e.$props.modelValue,"onUpdate:modelValue":e.onUpdate,onBlur:f[1]||(f[1]=S=>e.blurred=!0),search:e.innerSearch,"onUpdate:search":f[2]||(f[2]=S=>e.innerSearch=S)},e.$attrs),Me({clear:w(()=>[U(e.$slots,"clear",{},()=>[e.$props.editable&&e.$props.modelValue?(C(),$(ne,{key:0,icon:"mdi-close",variant:"icon",color:e.ColorEnum.Dark,onClick:f[0]||(f[0]=S=>e.$emit("update:modelValue",null))},null,8,["color"])):O("",!0)])]),"append-inner":w(()=>[U(e.$slots,"append-inner",{},()=>[n(ne,{icon:"mdi-chevron-down",variant:"icon",editable:e.$props.editable,color:e.ColorEnum.Dark},null,8,["editable","color"])])]),_:2},[Le(e.slots,(S,k)=>({name:k,fn:w(A=>[U(e.$slots,k,Ue(Ne(A)))])}))]),1040,["style","listProps","class","items","multiple","itemTitle","itemValue","readonly","loading","clearable","returnObject","rules","validateOn","modelValue","onUpdate:modelValue","search"]))],64)),U(e.$slots,"description",{},()=>[e.$props.description?(C(),$(H,{key:0,class:"fs-autocomplete-field-description",font:"text-underline",style:Z(e.style)},{default:w(()=>[K(oe(e.$props.description),1)]),_:1},8,["style"])):O("",!0)])]),_:3})}const Gl=We(ge,[["render",kl]]);ge.__docgenInfo={displayName:"FSAutocompleteField",exportName:"default",description:"",tags:{},props:[{name:"label",type:{name:"string | null"},required:!1,defaultValue:{func:!1,value:"null"}},{name:"description",type:{name:"string | null"},required:!1,defaultValue:{func:!1,value:"null"}},{name:"items",type:{name:"any[]"},required:!0},{name:"itemValue",type:{name:"string"},required:!1,defaultValue:{func:!1,value:'"id"'}},{name:"itemTitle",type:{name:"string"},required:!1,defaultValue:{func:!1,value:'"label"'}},{name:"modelValue",type:{name:"string[] | string | null"},required:!1,defaultValue:{func:!1,value:"null"}},{name:"multiple",type:{name:"boolean"},required:!1,defaultValue:{func:!1,value:"false"}},{name:"hideHeader",type:{name:"boolean"},required:!1,defaultValue:{func:!1,value:"false"}},{name:"returnObject",type:{name:"boolean"},required:!1,defaultValue:{func:!1,value:"false"}},{name:"required",type:{name:"boolean"},required:!1,defaultValue:{func:!1,value:"false"}},{name:"rules",type:{name:"any[]"},required:!1,defaultValue:{func:!0,value:"() => []"}},{name:"messages",type:{name:"string[]"},required:!1,defaultValue:{func:!1,value:"null"}},{name:"editable",type:{name:"boolean"},required:!1,defaultValue:{func:!1,value:"true"}},{name:"loading",type:{name:"boolean"},required:!1,defaultValue:{func:!1,value:"false"}},{name:"toggleSet",type:{name:"boolean"},required:!1,defaultValue:{func:!1,value:"false"}}],events:[{name:"update:modelValue"},{name:"update:search"}],slots:[{name:"label"},{name:"name",scoped:!0,bindings:[{name:"name",title:"binding"}]},{name:"clear"},{name:"append-inner"},{name:"description"}],sourceFiles:["/home/runner/work/foundation-shared-ui/foundation-shared-ui/src/shared/foundation-shared-components/components/fields/FSAutocompleteField.vue"]};export{Gl as F};
