var $=Object.defineProperty;var k=(a,e,l)=>e in a?$(a,e,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[e]=l;var n=(a,e,l)=>k(a,typeof e!="symbol"?e+"":e,l);import{b as v,d as w,c as P,y as g,z as T,A as y,B as b,O as N,L as r,U as x,w as F,M as V,N as q,m as A,I as z,J as E,K}from"./vue.esm-bundler-CxS4_7kK.js";import{F as G,V as M}from"./FSLoader-BMQDJgx0.js";import{F as h}from"./FSCol-Co9r7Klj.js";import{_ as p}from"./FSRow-D546kqFt.js";import{u as j,C as J}from"./useColors-CVdO3CcM.js";import{_ as C}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as H}from"./VSpacer-DaRxrr8q.js";import{F as Q}from"./FSDataTableUI-B_zQtXm0.js";import{C as W}from"./base-CaOb73CX.js";import{S as X}from"./serviceFactory-DAEdCiSt.js";import{C as B}from"./composableFactory-935AgDKu.js";import{u as Y}from"./FSFadeOut-D40FnrcD.js";class Z{constructor(){n(this,"called",!1);n(this,"result",null)}call(e){return this.called?this.result:(this.called=!0,this.result=e(),this.result)}}const f=v({}),ee=new Z,ae=()=>ee.call(()=>({getTable:l=>f.value[l]!=null?f.value[l]:null,setTable:(l,m)=>{f.value[l]={...m}}}));class te{constructor(e){n(this,"columnId");n(this,"text");n(this,"value");n(this,"sortable");n(this,"filterable");n(this,"index");n(this,"hidden");this.columnId=e.columnId,this.text=e.text,this.value=e.value,this.sortable=e.sortable,this.filterable=e.filterable,this.index=e.index,this.hidden=e.hidden}}class oe{constructor(e){n(this,"id");n(this,"code");n(this,"columns");n(this,"mode");n(this,"rowsPerPage");n(this,"sortByKey");n(this,"sortByOrder");var l;this.id=e.id,this.code=e.code,this.mode=e.mode,this.rowsPerPage=e.rowsPerPage,this.sortByKey=e.sortByKey,this.sortByOrder=e.sortByOrder,this.columns=((l=e.columns)==null?void 0:l.map(m=>new te(m)))??[]}}class se extends oe{constructor(e){super(e)}}const le=()=>`${W()}/user-organisation-tables`,U=a=>`${le()}/${encodeURIComponent(a)}`,ne=()=>{const a=v(!1),e=v({headers:[],mode:"iterator",sortBy:null,rowsPerPage:10,filters:{},page:1});return{initialized:a,table:e,onTableCodeChange:async(o,t,i,s="table")=>{if(i){const d=t(i);if(d)e.value=d;else try{const u=await o(i);u.value?e.value={headers:u.value.columns,sortBy:{key:u.value.sortByKey,order:u.value.sortByOrder},mode:u.value.mode,rowsPerPage:u.value.rowsPerPage,filters:{},page:1}:e.value.mode=s}catch{e.value.mode=s}}a.value=!0},computeTable:o=>({...e.value,headers:e.value.headers.map(t=>({...t,fixedFilters:t.value&&o[t.value]&&o[t.value].fixedFilters||null,methodFilter:t.value&&o[t.value]&&o[t.value].methodFilter||null,methodFilterRaw:t.value&&o[t.value]&&o[t.value].methodFilterRaw||null,sort:t.value&&o[t.value]&&o[t.value].sort||null,sortRaw:t.value&&o[t.value]&&o[t.value].sortRaw||null,innerValue:t.value&&o[t.value]&&o[t.value].innerValue||null}))}),updateTable:(o,t,i)=>{var s,d;e.value&&(t(i,e.value),o(i,{columns:e.value.headers.map(u=>({columnId:u.columnId,hidden:u.hidden,index:u.index})),rowsPerPage:e.value.rowsPerPage,sortByKey:((s=e.value.sortBy)==null?void 0:s.key)??null,sortByOrder:((d=e.value.sortBy)==null?void 0:d.order)??null,mode:e.value.mode}))}}},I=new X("userOrgansiationTable",se).create(a=>a.build(a.addGet(U),a.addUpdate(U),a.addNotify())),re=B.get(I),ue=B.update(I),D=w({name:"FSLoadDataTable",components:{FSLoader:G,FSCol:h,FSRow:p},setup(){const{getColors:a}=j(),e=a(J.Background);return{style:P(()=>({"--fs-load-data-table-background-color":e.base}))}}});function ie(a,e,l,m,c,o){const t=g("FSLoader");return T(),y(h,{class:"fs-load-data-table",gap:"16px",style:N(a.style)},{default:b(()=>[r(p,{align:"bottom-center"},{default:b(()=>[r(t,{variant:"input"}),r(t,{variant:"button"}),r(H),r(t,{variant:"button"}),r(t,{variant:"button"})]),_:1}),r(p,null,{default:b(()=>[r(t,{variant:"chip"}),r(t,{variant:"chip"}),r(t,{variant:"chip"})]),_:1}),r(M,{type:"table-row-divider@10"}),r(p,{align:"center-right"},{default:b(()=>[r(t,{height:"16px",width:"100px"}),r(t,{width:"120px",height:["40px","36px"]}),r(t,{variant:"button"}),r(t,{variant:"button"}),r(t,{variant:"button"})]),_:1})]),_:1},8,["style"])}const de=C(D,[["render",ie]]);D.__docgenInfo={displayName:"FSLoadDataTable",exportName:"default",description:"",tags:{},sourceFiles:["/home/runner/work/foundation-shared-ui/foundation-shared-ui/src/shared/foundation-shared-components/components/lists/FSLoadDataTable.vue"]};const L=w({name:"FSDataTable",components:{FSLoadDataTable:de,FSDataTableUI:Q},props:{defaultMode:{type:String,required:!1,default:"table"},tableCode:{type:String,required:!0},debounceTime:{type:Number,required:!1,default:1e3},headersOptions:{type:Object,required:!1,default:()=>({})}},setup(a){const{get:e,getting:l}=re(),{initialized:m,table:c,updateTable:o,computeTable:t,onTableCodeChange:i}=ne(),{update:s}=ue(),{getTable:d,setTable:u}=ae(),{debounce:O,cancel:R}=Y(),_=P(()=>t(a.headersOptions));x(()=>{R(),S()});const S=()=>{o(s,u,a.tableCode)};return F(()=>a.tableCode,async()=>{i(e,d,a.tableCode,a.defaultMode)},{immediate:!0}),F(()=>c.value,()=>{c.value&&m.value&&O(S,a.debounceTime)},{deep:!0}),{gettingUserOrganisationTable:l,computedTable:_,initialized:m,table:c}}});function me(a,e,l,m,c,o){const t=g("FSLoadDataTable"),i=g("FSDataTableUI");return!a.initialized||a.gettingUserOrganisationTable?(T(),y(t,{key:0})):(T(),y(i,A({key:1,"onUpdate:rowsPerPage":e[0]||(e[0]=s=>a.table.rowsPerPage=s),"onUpdate:filters":e[1]||(e[1]=s=>a.table.filters=s),"onUpdate:headers":e[2]||(e[2]=s=>a.table.headers=s),"onUpdate:sortBy":e[3]||(e[3]=s=>a.table.sortBy=s),"onUpdate:mode":e[4]||(e[4]=s=>a.table.mode=s),"onUpdate:page":e[5]||(e[5]=s=>a.table.page=s)},{...a.computedTable,...a.$attrs}),V({_:2},[q(a.$slots,(s,d)=>({name:d,fn:b(u=>[z(a.$slots,d,E(K(u)))])}))]),1040))}const he=C(L,[["render",me]]);L.__docgenInfo={displayName:"FSDataTable",exportName:"default",description:"",tags:{},props:[{name:"defaultMode",values:["table","iterator"],type:{name:"string"},required:!1,defaultValue:{func:!1,value:'"table"'}},{name:"tableCode",type:{name:"string"},required:!0},{name:"debounceTime",type:{name:"number"},required:!1,defaultValue:{func:!1,value:"1000"}},{name:"headersOptions",type:{name:"{ [key: string]: Partial<FSDataTableColumn> }"},required:!1,defaultValue:{func:!0,value:"() => ({})"}}],slots:[{name:"name",scoped:!0,bindings:[{name:"name",title:"binding"}]}],sourceFiles:["/home/runner/work/foundation-shared-ui/foundation-shared-ui/src/core/foundation-core-components/components/lists/FSDataTable.vue"]};export{he as F};
