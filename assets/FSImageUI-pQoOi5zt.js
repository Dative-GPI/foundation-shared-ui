import{d as O,b as B,c as h,w as T,y as j,z as q,A as V,C as H,m as z,F,V as G}from"./vue.esm-bundler-Ddr6MgcY.js";import{F as L}from"./FSLoader-Bw_zeuUP.js";import{s as f,v as N}from"./css-CxoeZkpP.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as W}from"./VImg-Bi-pKvLj.js";var x=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","#","$","%","*","+",",","-",".",":",";","=","?","@","[","]","^","_","{","|","}","~"],c=e=>{let a=0;for(let t=0;t<e.length;t++){let l=e[t],i=x.indexOf(l);a=a*83+i}return a},$=e=>{let a=e/255;return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)},M=e=>{let a=Math.max(0,Math.min(1,e));return a<=.0031308?Math.trunc(a*12.92*255+.5):Math.trunc((1.055*Math.pow(a,.4166666666666667)-.055)*255+.5)},_=e=>e<0?-1:1,I=(e,a)=>_(e)*Math.pow(Math.abs(e),a),C=class extends Error{constructor(e){super(e),this.name="ValidationError",this.message=e}},D=e=>{if(!e||e.length<6)throw new C("The blurhash string must be at least 6 characters");let a=c(e[0]),t=Math.floor(a/9)+1,l=a%9+1;if(e.length!==4+2*l*t)throw new C(`blurhash length mismatch: length is ${e.length} but it should be ${4+2*l*t}`)},J=e=>{try{D(e)}catch(a){return{result:!1,errorReason:a.message}}return{result:!0}},K=e=>{let a=e>>16,t=e>>8&255,l=e&255;return[$(a),$(t),$(l)]},Q=(e,a)=>{let t=Math.floor(e/361),l=Math.floor(e/19)%19,i=e%19;return[I((t-9)/9,2)*a,I((l-9)/9,2)*a,I((i-9)/9,2)*a]},X=(e,a,t,l)=>{D(e),l=l|1;let i=c(e[0]),m=Math.floor(i/9)+1,s=i%9+1,b=(c(e[1])+1)/166,d=new Array(s*m);for(let r=0;r<d.length;r++)if(r===0){let u=c(e.substring(2,6));d[r]=K(u)}else{let u=c(e.substring(4+r*2,6+r*2));d[r]=Q(u,b*l)}let o=a*4,n=new Uint8ClampedArray(o*t);for(let r=0;r<t;r++)for(let u=0;u<a;u++){let v=0,g=0,S=0;for(let y=0;y<m;y++)for(let w=0;w<s;w++){let R=Math.cos(Math.PI*u*w/a)*Math.cos(Math.PI*r*y/t),p=d[w+y*s];v+=p[0]*R,g+=p[1]*R,S+=p[2]*R}let k=M(v),A=M(g),E=M(S);n[4*u+0+r*o]=k,n[4*u+1+r*o]=A,n[4*u+2+r*o]=E,n[4*u+3+r*o]=255}return n},Y=X;const U=O({name:"FSImageUI",components:{FSLoader:L},props:{height:{type:[Array,String,Number],required:!1,default:null},width:{type:[Array,String,Number],required:!1,default:null},aspectRatio:{type:Number,required:!1,default:1},imageB64:{type:String,required:!1,default:null},source:{type:String,required:!1,default:null},blurHash:{type:Object,required:!1,default:null},borderRadius:{type:[String,Number],required:!1,default:"4px"},cover:{type:Boolean,required:!1,default:!0},loading:{type:Boolean,required:!1,default:!1}},setup(e){const a=B(null),t=B(null),l=B({JVBERi0:"application/pdf",R0lGODdh:"image/gif",R0lGODlh:"image/gif",iVBORw0KGgo:"image/png","/9j/":"image/jpg"}),i=h(()=>({"--fs-image-border-radius":f(e.borderRadius),"--fs-image-blurhash-opacity":e.blurHash?"1":"0"})),m=h(()=>{if(e.height)return f(e.height);if(e.width)return typeof e.width=="string"?void 0:e.aspectRatio?f(N(e.width)/e.aspectRatio):f(e.width)}),s=h(()=>{if(e.width)return f(e.width);if(e.height)return typeof e.height=="string"?void 0:e.aspectRatio?f(N(e.height)*e.aspectRatio):f(e.height)}),b=h(()=>{if(e.imageB64){if(o.value&&d.value)return`${o.value},${d.value}`}else if(e.source)return e.source}),d=h(()=>e.imageB64&&e.imageB64.includes(",")?e.imageB64.split(",")[1]:e.imageB64),o=h(()=>{if(e.imageB64&&e.imageB64.includes(","))return e.imageB64.split(",")[0];if(e.imageB64){for(const n in l.value)if(e.imageB64.startsWith(n))return`data:${l.value[n]};base64`}return null});return T(()=>e.blurHash,()=>{if(t.value&&a.value&&e.blurHash&&J(e.blurHash.blurHash).result){const n=t.value.getContext("2d");if(n){const r=a.value.$el.clientWidth,u=a.value.$el.clientHeight,v=Y(e.blurHash.blurHash,r,u),g=n.createImageData(r,u);t.value.width=r,t.value.height=u,g.data.set(v),n.putImageData(g,0,0)}}}),{computedHeight:m,computedWidth:s,realSource:b,canvasRef:t,imageRef:a,style:i}}}),Z={ref:"canvasRef"};function ee(e,a,t,l,i,m){const s=j("FSLoader");return q(),V(W,z({class:"fs-image",ref:"imageRef",height:e.computedHeight,width:e.computedWidth,cover:e.$props.cover,src:e.realSource,style:e.style,onError:a[0]||(a[0]=b=>e.$emit("error"))},e.$attrs),{placeholder:H(()=>[e.$props.loading?(q(),V(s,{key:0,class:"fs-image-load",height:"100%",width:"100%",borderRadius:e.$props.borderRadius},null,8,["borderRadius"])):F("",!0)]),error:H(()=>[e.$props.blurHash?F("",!0):(q(),V(s,{key:0,class:"fs-image-load",height:"100%",width:"100%",borderRadius:e.$props.borderRadius},null,8,["borderRadius"])),G("canvas",Z,null,512)]),_:1},16,["height","width","cover","src","style"])}const ne=P(U,[["render",ee]]);U.__docgenInfo={displayName:"FSImageUI",exportName:"default",description:"",tags:{},props:[{name:"height",type:{name:"string[] | number[] | string | number | null"},required:!1,defaultValue:{func:!1,value:"null"}},{name:"width",type:{name:"string[] | number[] | string | number | null"},required:!1,defaultValue:{func:!1,value:"null"}},{name:"aspectRatio",type:{name:"number | null"},required:!1,defaultValue:{func:!1,value:"1"}},{name:"imageB64",type:{name:"string | null"},required:!1,defaultValue:{func:!1,value:"null"}},{name:"source",type:{name:"string | null"},required:!1,defaultValue:{func:!1,value:"null"}},{name:"blurHash",type:{name:"ImageDetails | null"},required:!1,defaultValue:{func:!1,value:"null"}},{name:"borderRadius",type:{name:"string|number"},required:!1,defaultValue:{func:!1,value:'"4px"'}},{name:"cover",type:{name:"boolean"},required:!1,defaultValue:{func:!1,value:"true"}},{name:"loading",type:{name:"boolean"},required:!1,defaultValue:{func:!1,value:"false"}}],events:[{name:"error"}],sourceFiles:["/home/runner/work/foundation-shared-ui/foundation-shared-ui/src/shared/foundation-shared-components/components/FSImageUI.vue"]};export{ne as F};
