import{d as E,s as M,e as y,w as N,n as ie,z as n,F as H,x as P,P as j,j as Be,H as de,I as $,J as C,K as w,S as L,L as X,Q as oe,M as O,R as Oe,Y as Me,Z as Le,U as Ue,V as Ee}from"./vue.esm-bundler-96d0a5cc.js";import{_ as ne}from"./FSButton-892461f4.js";import{_ as K}from"./FSSpan-572d1125.js";import{_ as ve}from"./FSCol-71088900.js";import{_ as ge}from"./FSRow-959288e5.js";import{F as Ne}from"./FSLoader-a4b17375.js";import{F as je}from"./FSToggleSet-d129dae9.js";import{u as Ke}from"./useRules-d4bb430c.js";import{u as He,C as U}from"./useColors-a5c6eb1e.js";import{u as ze}from"./useSlots-8f090340.js";import{_ as Je}from"./_plugin-vue_export-helper-c27b6911.js";import{V as Qe}from"./VSpacer-f03e5178.js";import{m as We,u as Ye,a as Ze,b as Ge,c as fe,d as Xe,e as _e,f as xe}from"./VSelect-a10f1a69.js";import{m as el,V as ce}from"./VTextField-10bbe6c7.js";import{u as ll}from"./color-0e7f3458.js";import{m as al,u as tl}from"./filter-14ef3d92.js";import{b as ol}from"./VInput-b0770754.js";import{f as ul}from"./forwardRefs-e658ad70.js";import{u as nl}from"./locale-ebcc9fd1.js";import{u as ue}from"./proxiedModel-80fa8b72.js";import{m as sl}from"./transition-2009bd3b.js";import{V as rl}from"./VMenu-564fd94d.js";import{V as il}from"./VCheckboxBtn-080209f7.js";import{V as me}from"./VIcon-356fc7cc.js";import{V as dl}from"./VDefaultsProvider-638492ec.js";import{p as fl,o as cl,I as ml,O as pl,P as vl,w as gl,M as pe}from"./theme-c90fedb5.js";import{g as yl,u as Vl}from"./useRender-864589a6.js";function hl(e,f,a){if(f==null)return e;if(Array.isArray(f))throw new Error("Multiple matches is not implemented");return typeof f=="number"&&~f?n(H,null,[n("span",{class:"v-autocomplete__unmask"},[e.substr(0,f)]),n("span",{class:"v-autocomplete__mask"},[e.substr(f,a)]),n("span",{class:"v-autocomplete__unmask"},[e.substr(f+a)])]):e}const bl=fl({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:Boolean,search:String,...al({filterKeys:["title"]}),...We(),...cl(el({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...sl({transition:!1})},"VAutocomplete"),Sl=yl()({name:"VAutocomplete",props:bl(),emits:{"update:focused":e=>!0,"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,f){let{slots:a}=f;const{t:D}=nl(),V=E(),p=M(!1),v=M(!0),q=M(!1),S=E(),k=E(),A=ue(e,"menu"),s=y({get:()=>A.value,set:l=>{var t;A.value&&!l&&((t=S.value)!=null&&t.Î¨openChildren)||(A.value=l)}}),r=M(-1),_=y(()=>{var l;return(l=V.value)==null?void 0:l.color}),z=y(()=>s.value?e.closeText:e.openText),{items:J,transformIn:x,transformOut:R}=Ye(e),{textColorClasses:Ve,textColorStyles:he}=ll(_),c=ue(e,"search",""),u=ue(e,"modelValue",[],l=>x(l===null?[null]:gl(l)),l=>{const t=R(l);return e.multiple?t:t[0]??null}),be=y(()=>typeof e.counterValue=="function"?e.counterValue(u.value):typeof e.counterValue=="number"?e.counterValue:u.value.length),B=ol(),{filteredItems:ee,getMatches:Se}=tl(e,J,()=>v.value?"":c.value),F=y(()=>e.hideSelected?ee.value.filter(l=>!u.value.some(t=>t.value===l.value)):ee.value),Q=y(()=>!!(e.chips||a.chip)),W=y(()=>Q.value||!!a.selection),ke=y(()=>u.value.map(l=>l.props.value)),Y=y(()=>{var t;return(e.autoSelectFirst===!0||e.autoSelectFirst==="exact"&&c.value===((t=F.value[0])==null?void 0:t.title))&&F.value.length>0&&!v.value&&!q.value}),le=y(()=>e.hideNoData&&!F.value.length||e.readonly||(B==null?void 0:B.isReadonly.value)),ae=E(),{onListScroll:Fe,onListKeydown:$e}=Ze(ae,V);function Ce(l){e.openOnClear&&(s.value=!0),c.value=""}function we(){le.value||(s.value=!0)}function qe(l){le.value||(p.value&&(l.preventDefault(),l.stopPropagation()),s.value=!s.value)}function Ae(l){var o,i,h;if(e.readonly||B!=null&&B.isReadonly.value)return;const t=V.value.selectionStart,d=u.value.length;if((r.value>-1||["Enter","ArrowDown","ArrowUp"].includes(l.key))&&l.preventDefault(),["Enter","ArrowDown"].includes(l.key)&&(s.value=!0),["Escape"].includes(l.key)&&(s.value=!1),Y.value&&["Enter","Tab"].includes(l.key)&&T(F.value[0]),l.key==="ArrowDown"&&Y.value&&((o=ae.value)==null||o.focus("next")),["Backspace","Delete"].includes(l.key)){if(!e.multiple&&W.value&&u.value.length>0)return T(u.value[0],!1);if(r.value<0){l.key==="Backspace"&&!c.value&&(r.value=d-1);return}const m=r.value;T(u.value[r.value],!1),r.value=m>=d-1?d-2:m}if(e.multiple){if(l.key==="ArrowLeft"){if(r.value<0&&t>0)return;const m=r.value>-1?r.value-1:d-1;u.value[m]?r.value=m:(r.value=-1,V.value.setSelectionRange((i=c.value)==null?void 0:i.length,(h=c.value)==null?void 0:h.length))}if(l.key==="ArrowRight"){if(r.value<0)return;const m=r.value+1;u.value[m]?r.value=m:(r.value=-1,V.value.setSelectionRange(0,0))}}}function Te(l){if(pe(V.value,":autofill")||pe(V.value,":-webkit-autofill")){const t=J.value.find(d=>d.title===l.target.value);t&&T(t)}}function Pe(){var l;p.value&&(v.value=!0,(l=V.value)==null||l.focus())}function Ie(l){p.value=!0,setTimeout(()=>{q.value=!0})}function De(l){q.value=!1}function Re(l){(l==null||l===""&&!e.multiple)&&(u.value=[])}const te=M(!1);function T(l){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!l||l.props.disabled))if(e.multiple){const d=u.value.findIndex(i=>e.valueComparator(i.value,l.value)),o=t??!~d;if(~d){const i=o?[...u.value,l]:[...u.value];i.splice(d,1),u.value=i}else o&&(u.value=[...u.value,l]);e.clearOnSelect&&(c.value="")}else{const d=t!==!1;u.value=d?[l]:[],c.value=d&&!W.value?l.title:"",ie(()=>{s.value=!1,v.value=!0})}}return N(p,(l,t)=>{var d;l!==t&&(l?(te.value=!0,c.value=e.multiple||W.value?"":String(((d=u.value.at(-1))==null?void 0:d.props.title)??""),v.value=!0,ie(()=>te.value=!1)):(!e.multiple&&c.value==null?u.value=[]:Y.value&&!q.value&&!u.value.some(o=>{let{value:i}=o;return i===F.value[0].value})&&T(F.value[0]),s.value=!1,c.value="",r.value=-1))}),N(c,l=>{!p.value||te.value||(l&&(s.value=!0),v.value=!l)}),N(s,()=>{if(!e.hideSelected&&s.value&&u.value.length){const l=F.value.findIndex(t=>u.value.some(d=>t.value===d.value));ml&&window.requestAnimationFrame(()=>{var t;l>=0&&((t=k.value)==null||t.scrollToIndex(l))})}}),N(()=>e.items,(l,t)=>{s.value||p.value&&!t.length&&l.length&&(s.value=!0)}),Vl(()=>{const l=!!(!e.hideNoData||F.value.length||a["prepend-item"]||a["append-item"]||a["no-data"]),t=u.value.length>0,d=ce.filterProps(e);return n(ce,P({ref:V},d,{modelValue:c.value,"onUpdate:modelValue":[o=>c.value=o,Re],focused:p.value,"onUpdate:focused":o=>p.value=o,validationValue:u.externalValue,counterValue:be.value,dirty:t,onChange:Te,class:["v-autocomplete",`v-autocomplete--${e.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":s.value,"v-autocomplete--chips":!!e.chips,"v-autocomplete--selection-slot":!!W.value,"v-autocomplete--selecting-index":r.value>-1},e.class],style:e.style,readonly:e.readonly,placeholder:t?void 0:e.placeholder,"onClick:clear":Ce,"onMousedown:control":we,onKeydown:Ae}),{...a,default:()=>n(H,null,[n(rl,P({ref:S,modelValue:s.value,"onUpdate:modelValue":o=>s.value=o,activator:"parent",contentClass:"v-autocomplete__content",disabled:le.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:Pe},e.menuProps),{default:()=>[l&&n(Ge,P({ref:ae,selected:ke.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:o=>o.preventDefault(),onKeydown:$e,onFocusin:Ie,onFocusout:De,onScrollPassive:Fe,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},e.listProps),{default:()=>{var o,i,h;return[(o=a["prepend-item"])==null?void 0:o.call(a),!F.value.length&&!e.hideNoData&&(((i=a["no-data"])==null?void 0:i.call(a))??n(fe,{title:D(e.noDataText)},null)),n(Xe,{ref:k,renderless:!0,items:F.value},{default:m=>{var re;let{item:g,index:I,itemRef:b}=m;const se=P(g.props,{ref:b,key:I,active:Y.value&&I===0?!0:void 0,onClick:()=>T(g,null)});return((re=a.item)==null?void 0:re.call(a,{item:g,index:I,props:se}))??n(fe,P(se,{role:"option"}),{prepend:Z=>{let{isSelected:G}=Z;return n(H,null,[e.multiple&&!e.hideSelected?n(il,{key:g.value,modelValue:G,ripple:!1,tabindex:"-1"},null):void 0,g.props.prependAvatar&&n(_e,{image:g.props.prependAvatar},null),g.props.prependIcon&&n(me,{icon:g.props.prependIcon},null)])},title:()=>{var Z,G;return v.value?g.title:hl(g.title,(Z=Se(g))==null?void 0:Z.title,((G=c.value)==null?void 0:G.length)??0)}})}}),(h=a["append-item"])==null?void 0:h.call(a)]}})]}),u.value.map((o,i)=>{function h(b){b.stopPropagation(),b.preventDefault(),T(o,!1)}const m={"onClick:close":h,onKeydown(b){b.key!=="Enter"&&b.key!==" "||(b.preventDefault(),b.stopPropagation(),h(b))},onMousedown(b){b.preventDefault(),b.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},g=Q.value?!!a.chip:!!a.selection,I=g?pl(Q.value?a.chip({item:o,index:i,props:m}):a.selection({item:o,index:i})):void 0;if(!(g&&!I))return n("div",{key:o.value,class:["v-autocomplete__selection",i===r.value&&["v-autocomplete__selection--selected",Ve.value]],style:i===r.value?he.value:{}},[Q.value?a.chip?n(dl,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:o.title}}},{default:()=>[I]}):n(xe,P({key:"chip",closable:e.closableChips,size:"small",text:o.title,disabled:o.props.disabled},m),null):I??n("span",{class:"v-autocomplete__selection-text"},[o.title,e.multiple&&i<u.value.length-1&&n("span",{class:"v-autocomplete__selection-comma"},[j(",")])])])})]),"append-inner":function(){var m;for(var o=arguments.length,i=new Array(o),h=0;h<o;h++)i[h]=arguments[h];return n(H,null,[(m=a["append-inner"])==null?void 0:m.call(a,...i),e.menuIcon?n(me,{class:"v-autocomplete__menu-icon",icon:e.menuIcon,onMousedown:qe,onClick:vl,"aria-label":D(z.value),title:D(z.value)},null):void 0])}})}),ul({isFocused:p,isPristine:v,menu:s,search:c,filteredItems:ee,select:T},V)}}),ye=Be({name:"FSAutocompleteField",components:{FSButton:ne,FSSpan:K,FSCol:ve,FSRow:ge,FSLoader:Ne,FSToggleSet:je},props:{label:{type:String,required:!1,default:null},description:{type:String,required:!1,default:null},items:{type:Array,required:!0},itemValue:{type:String,required:!1,default:"id"},itemTitle:{type:String,required:!1,default:"label"},modelValue:{type:[Array,String],required:!1,default:null},multiple:{type:Boolean,required:!1,default:!1},hideHeader:{type:Boolean,required:!1,default:!1},returnObject:{type:Boolean,required:!1,default:!1},required:{type:Boolean,required:!1,default:!1},rules:{type:Array,required:!1,default:()=>[]},messages:{type:Array,required:!1,default:null},editable:{type:Boolean,required:!1,default:!0},loading:{type:Boolean,required:!1,default:!1},disableToggleSet:{type:Boolean,required:!1,default:!1},toggleSetTreshold:{type:Number,required:!1,default:6}},emits:["update:modelValue","update:search"],setup:(e,{emit:f})=>{const{validateOn:a,blurred:D,getMessages:V}=Ke(),{getColors:p}=He(),{slots:v}=ze();delete v.label,delete v.description;const q=p(U.Background),S=p(U.Error),k=p(U.Light),A=p(U.Dark),s=E(""),r=y(()=>e.editable?{"--fs-autocomplete-field-cursor":"text","--fs-autocomplete-field-background-color":q.base,"--fs-autocomplete-field-border-color":k.dark,"--fs-autocomplete-field-color":A.base,"--fs-autocomplete-field-active-border-color":A.dark,"--fs-autocomplete-field-error-color":S.base,"--fs-autocomplete-field-error-border-color":S.base}:{"--fs-autocomplete-field-cursor":"default","--fs-autocomplete-field-border-color":k.base,"--fs-autocomplete-field-color":k.dark,"--fs-autocomplete-field-active-border-color":k.base}),_=y(()=>({style:r.value})),z=y(()=>{const R=["fs-autocomplete-field"];return e.multiple&&R.push("fs-autocomplete-multiple-field"),R}),J=y(()=>e.messages??V(e.modelValue,e.rules)),x=R=>{f("update:modelValue",R),s.value=""};return N(s,()=>{f("update:search",s.value)}),{innerSearch:s,validateOn:a,ColorEnum:U,listStyle:_,messages:J,blurred:D,classes:z,slots:v,style:r,onUpdate:x}}});function kl(e,f,a,D,V,p){const v=de("FSLoader"),q=de("FSToggleSet");return $(),C(ve,null,{default:w(()=>[e.$props.hideHeader?O("",!0):L(e.$slots,"label",{key:0},()=>[n(ge,{wrap:!1},{default:w(()=>[e.$props.label?($(),C(K,{key:0,class:"fs-autocomplete-field-label",font:"text-overline",style:X(e.style)},{default:w(()=>[j(oe(e.$props.label),1)]),_:1},8,["style"])):O("",!0),e.$props.label&&e.$props.required?($(),C(K,{key:1,class:"fs-autocomplete-field-label",style:X([{"margin-left":"-8px"},e.style]),font:"text-overline",ellipsis:!1},{default:w(()=>[j(" * ")]),_:1},8,["style"])):O("",!0),n(Qe,{style:{"min-width":"40px"}}),e.messages.length>0?($(),C(K,{key:2,class:"fs-autocomplete-field-messages",font:"text-overline",style:X(e.style)},{default:w(()=>[j(oe(e.messages.join(", ")),1)]),_:1},8,["style"])):O("",!0)]),_:1})]),!e.$props.disableToggleSet&&e.$props.items.length<e.$props.toggleSetTreshold?($(),Oe(H,{key:1},[e.$props.loading?($(),C(v,{key:0,width:"100%",height:["40px","36px"]})):($(),C(q,P({key:1,values:e.$props.items,multiple:e.$props.multiple,modelValue:e.$props.modelValue,"onUpdate:modelValue":e.onUpdate},e.$attrs),null,16,["values","multiple","modelValue","onUpdate:modelValue"]))],64)):($(),C(Sl,P({key:2,class:["fs-autocomplete-field",e.classes],menuIcon:"mdi-chevron-down",clearIcon:"mdi-close",variant:"outlined",style:e.style,listProps:e.listStyle,hideDetails:!0,items:e.$props.items,autoSelectFirst:!0,multiple:e.$props.multiple,itemTitle:e.$props.itemTitle,itemValue:e.$props.itemValue,readonly:!e.$props.editable,loading:e.$props.loading,clearable:e.$props.editable&&!!e.$props.modelValue,returnObject:e.$props.returnObject,rules:e.$props.rules,validateOn:e.validateOn,modelValue:e.$props.modelValue,"onUpdate:modelValue":e.onUpdate,onBlur:f[1]||(f[1]=S=>e.blurred=!0),search:e.innerSearch,"onUpdate:search":f[2]||(f[2]=S=>e.innerSearch=S)},e.$attrs),Me({clear:w(()=>[L(e.$slots,"clear",{},()=>[e.$props.editable&&e.$props.modelValue?($(),C(ne,{key:0,icon:"mdi-close",variant:"icon",color:e.ColorEnum.Dark,onClick:f[0]||(f[0]=S=>e.$emit("update:modelValue",null))},null,8,["color"])):O("",!0)])]),"append-inner":w(()=>[L(e.$slots,"append-inner",{},()=>[n(ne,{icon:"mdi-chevron-down",variant:"icon",editable:e.$props.editable,color:e.ColorEnum.Dark},null,8,["editable","color"])])]),_:2},[Le(e.slots,(S,k)=>({name:k,fn:w(A=>[L(e.$slots,k,Ue(Ee(A)))])}))]),1040,["style","listProps","class","items","multiple","itemTitle","itemValue","readonly","loading","clearable","returnObject","rules","validateOn","modelValue","onUpdate:modelValue","search"])),L(e.$slots,"description",{},()=>[e.$props.description?($(),C(K,{key:0,class:"fs-autocomplete-field-description",font:"text-underline",style:X(e.style)},{default:w(()=>[j(oe(e.$props.description),1)]),_:1},8,["style"])):O("",!0)])]),_:3})}const Gl=Je(ye,[["render",kl]]);ye.__docgenInfo={displayName:"FSAutocompleteField",exportName:"default",description:"",tags:{},props:[{name:"label",type:{name:"string | null"},required:!1,defaultValue:{func:!1,value:"null"}},{name:"description",type:{name:"string | null"},required:!1,defaultValue:{func:!1,value:"null"}},{name:"items",type:{name:"any[]"},required:!0},{name:"itemValue",type:{name:"string"},required:!1,defaultValue:{func:!1,value:'"id"'}},{name:"itemTitle",type:{name:"string"},required:!1,defaultValue:{func:!1,value:'"label"'}},{name:"modelValue",type:{name:"string[] | string | null"},required:!1,defaultValue:{func:!1,value:"null"}},{name:"multiple",type:{name:"boolean"},required:!1,defaultValue:{func:!1,value:"false"}},{name:"hideHeader",type:{name:"boolean"},required:!1,defaultValue:{func:!1,value:"false"}},{name:"returnObject",type:{name:"boolean"},required:!1,defaultValue:{func:!1,value:"false"}},{name:"required",type:{name:"boolean"},required:!1,defaultValue:{func:!1,value:"false"}},{name:"rules",type:{name:"any[]"},required:!1,defaultValue:{func:!0,value:"() => []"}},{name:"messages",type:{name:"string[]"},required:!1,defaultValue:{func:!1,value:"null"}},{name:"editable",type:{name:"boolean"},required:!1,defaultValue:{func:!1,value:"true"}},{name:"loading",type:{name:"boolean"},required:!1,defaultValue:{func:!1,value:"false"}},{name:"disableToggleSet",type:{name:"boolean"},required:!1,defaultValue:{func:!1,value:"false"}},{name:"toggleSetTreshold",type:{name:"number"},required:!1,defaultValue:{func:!1,value:"6"}}],events:[{name:"update:modelValue"},{name:"update:search"}],slots:[{name:"label"},{name:"name",scoped:!0,bindings:[{name:"name",title:"binding"}]},{name:"clear"},{name:"append-inner"},{name:"description"}],sourceFiles:["/home/runner/work/foundation-shared-ui/foundation-shared-ui/src/shared/foundation-shared-components/components/fields/FSAutocompleteField.vue"]};export{Gl as F};
