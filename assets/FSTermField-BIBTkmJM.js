import{u as z}from"./useAppTimeZone-DyFwBRoB.js";import{u as N}from"./useDateFormat-BIFVETfU.js";import{d as C,c as V,z as P,H as S,m as G,G as g,b as k,w as X,q as Z,C as h,P as D,A as j,E as J,F as K,I as L}from"./vue.esm-bundler-PTWG9x2X.js";import{_ as A}from"./lodash-BrWYvtk2.js";import{F as Q}from"./FSSelectField-7K2ABFnn.js";import{b as e}from"./dates-CU5b-tXh.js";import{u as _}from"./useTranslations-BnE68qER.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{F as ee}from"./FSDateTimeRangeField-lqruXG3I.js";import ae from"./FSNumberField-B9vi_xGa.js";import{F as te}from"./FSBaseField-DcQpuQod.js";import{F as B}from"./FSTextField-Bd-6am9D.js";import{F as re}from"./FSForm-uibijjXy.js";import{F as q}from"./FSIcon-Df5FR-8G.js";import{_ as M}from"./FSRow-DPcQMiM9.js";import{a as le,D as ne,N as se}from"./rules-Bi0-Tpmi.js";import{u as ue}from"./useRules-D0leB7Wy.js";const Me=()=>{const{getOffsetDifference:t}=z(),{parseForPicker:l}=N(),v=/(?:(?:([-\+])(\d*))?(\w+))?(?:\/(\w))?/g,c="now",p=(a,r={})=>{const d=l(a);if(d)return d;const o={...r,[c]:new Date().getTime()};return m(a,o)},m=(a,r)=>{a=a.replace(/\s/g,"");const d=a.matchAll(v);if(!d)return console.error("Invalid expression"),NaN;let o=0;return d.forEach(f=>{const i=f[1],w=f[2],$=f[3],F=f[4];$&&(o=b(o,i,w,$,r)),F&&(o=n(o,F))}),o},b=(a,r,d,o,f)=>{let i=r==="-"?-1:1;switch(i*=Number.isNaN(parseInt(d))?1:parseInt(d),o){case"s":return a+i*1e3;case"m":return a+i*60*1e3;case"h":return a+i*60*60*1e3;case"d":return new Date(a).setDate(new Date(a).getDate()+i);case"w":return new Date(a).setDate(new Date(a).getDate()+i*7);case"M":return new Date(a).setMonth(new Date(a).getMonth()+i);case"y":return new Date(a).setFullYear(new Date(a).getFullYear()+i);default:if(f[o]){const w=u(o,f);return a+i*w}else return console.error(`Invalid unit expression, unit ${o} is not defined in the variables`),a}},u=(a,r)=>{if(r[a]){const d=parseInt(r[a].toString());if(typeof r[a]=="number")return d;if(isNaN(d)){const o=r[a].toString(),f=m(o,r);return isNaN(f)?(console.error(`Invalid unit expression, unit ${a} is not defined in the variables`),0):f}else return d}else return console.error(`Invalid unit expression, unit ${a} is not defined in the variables`),0},n=(a,r)=>{switch(a+=t(a),r){case"h":return new Date(a).setMinutes(0,0,0)-t(a);case"d":return new Date(a).setHours(0,0,0,0)-t(a);case"w":const d=new Date(a),o=d.getDay(),f=d.getDate()-o+(o===0?-6:1);return new Date(d.setDate(f)).setHours(0,0,0,0)-t(a);case"M":const i=new Date(a);return new Date(i.setMonth(i.getMonth(),1)).setHours(0,0,0,0)-t(a);case"y":const w=new Date(a);return new Date(w.setMonth(0,1)).setHours(0,0,0,0)-t(a)}return a};return{convert:p}},E=C({name:"FSSelectDateSetting",components:{FSSelectField:Q},props:{variant:{type:String,required:!1,default:"default"},modelValue:{type:Number,required:!1,default:e.LastDay},lastPeriod:{type:Boolean,required:!1,default:!1},useNone:{type:Boolean,required:!1,default:!1}},emits:["update:modelValue"],setup(t){const{$tr:l}=_();return{dateSettings:V(()=>{if(t.variant==="before-after")return[{id:e.Pick,label:l("ui.date-setting.pick-dates","Pick dates")},{id:e.MinutesBeforeAfter,label:l("ui.date-setting.x-minutes-before-after-hour","x Minutes before/after")},{id:e.HoursBeforeAfter,label:l("ui.date-setting.x-hours-before-after-hour","x Hours before/after")},{id:e.DaysBeforeAfter,label:l("ui.date-setting.x-days-before-after-hour","x Days before/after")},{id:e.WeeksBeforeAfter,label:l("ui.date-setting.x-weeks-before-after-hour","x Weeks before/after")},{id:e.MinutesBefore,label:l("ui.date-setting.x-minutes-before","x Minutes before")},{id:e.HoursBefore,label:l("ui.date-setting.x-hours-before","x Hours before")},{id:e.DaysBefore,label:l("ui.date-setting.x-days-before","x Days before")},{id:e.WeeksBefore,label:l("ui.date-setting.x-weeks-before","x Weeks before")}];let c=[{id:e.Pick,label:l("ui.date-setting.pick-dates","Pick dates")},{id:e.CurrentHour,label:l("ui.date-setting.this-hour","This hour")},{id:e.CurrentDay,label:l("ui.date-setting.this-day","This day")},{id:e.CurrentWeek,label:l("ui.date-setting.this-week","This week")},{id:e.CurrentMonth,label:l("ui.date-setting.this-month","This month")},{id:e.CurrentYear,label:l("ui.date-setting.this-year","This year")},{id:e.LastDay,label:l("ui.date-setting.last-day","Last day")},{id:e.LastWeek,label:l("ui.date-setting.last-week","Last week")},{id:e.LastMonth,label:l("ui.date-setting.last-month","Last month")},{id:e.LastYear,label:l("ui.date-setting.last-year","Last year")},{id:e.SinceLastDay,label:l("ui.date-setting.since-last-day","Since last day")},{id:e.SinceLastWeek,label:l("ui.date-setting.since-last-week","Since last week")},{id:e.SinceLastMonth,label:l("ui.date-setting.since-last-month","Since last month")},{id:e.SinceLastYear,label:l("ui.date-setting.since-last-year","Since last year")},{id:e.PastHours,label:l("ui.date-setting.past-x-hours","Past x hours")},{id:e.PastDays,label:l("ui.date-setting.past-x-days","Past x days")},{id:e.PastWeeks,label:l("ui.date-setting.past-x-weeks","Past x weeks")},{id:e.PastMonths,label:l("ui.date-setting.past-x-months","Past x months")},{id:e.PastYears,label:l("ui.date-setting.past-x-years","Past x years")},{id:e.Expression,label:l("ui.date-setting.expression","Expression")}];return t.lastPeriod&&c.push({id:e.LastPeriod,label:l("ui.date-setting.last-period","Last period")}),t.useNone&&c.unshift({id:e.None,label:l("ui.common.none","None")}),c})}}});function de(t,l,v,c,p,m){const b=g("FSSelectField");return S(),P(b,G({class:"select.date-setting.label",items:t.dateSettings,clearable:!1,modelValue:t.$props.modelValue,"onUpdate:modelValue":l[0]||(l[0]=u=>t.$emit("update:modelValue",u))},t.$attrs),null,16,["items","modelValue"])}const oe=W(E,[["render",de]]);E.__docgenInfo={displayName:"FSSelectDateSetting",exportName:"default",description:"",tags:{},props:[{name:"variant",values:["default","before-after"],type:{name:"string"},required:!1,defaultValue:{func:!1,value:'"default"'}},{name:"modelValue",type:{name:"DateSetting"},required:!1,defaultValue:{func:!1,value:"DateSetting.LastDay"}},{name:"lastPeriod",type:{name:"boolean"},required:!1,defaultValue:{func:!1,value:"false"}},{name:"useNone",type:{name:"boolean"},required:!1,defaultValue:{func:!1,value:"false"}}],events:[{name:"update:modelValue"}],sourceFiles:["/home/runner/work/foundation-shared-ui/foundation-shared-ui/src/shared/foundation-shared-components/components/selects/FSSelectDateSetting.vue"]};const T=C({name:"FSTermField",components:{FSDateTimeRangeField:ee,FSSelectDateSetting:oe,FSNumberField:ae,FSBaseField:te,FSTextField:B,FSForm:re,FSIcon:q,FSRow:M},props:{label:{type:String,required:!1,default:null},description:{type:String,required:!1,default:null},startDate:{type:String,required:!0},endDate:{type:String,required:!0},variant:{type:String,required:!1,default:"default"},hideHeader:{type:Boolean,required:!1,default:!1},lastPeriod:{type:Boolean,required:!1,default:!1},required:{type:Boolean,required:!1,default:!1},rules:{type:Array,required:!1,default:()=>[]},messages:{type:Array,required:!1,default:null},disabled:{type:Boolean,required:!1,default:!1}},emits:["update","update:startDate","update:endDate"],setup(t,{emit:l}){const{parseForPicker:v,epochToISO:c,todayToPicker:p,yesterdayToPicker:m}=N(),{getMessages:b}=ue(),u=k(e.PastDays),n=k(1),a=k("now - 1d"),r=k("now"),d=k(!1),o=V(()=>[e.PastHours,e.PastDays,e.PastWeeks,e.PastMonths,e.PastYears,e.MinutesBeforeAfter,e.HoursBeforeAfter,e.DaysBeforeAfter,e.WeeksBeforeAfter,e.MinutesBefore,e.HoursBefore,e.DaysBefore,e.WeeksBefore]),f=V(()=>{const s=[v(a.value),v(r.value)];return s.some(y=>y==null)?null:s}),i=V(()=>t.messages??b(t.startDate,t.rules).concat(b(t.endDate,t.rules))),w=s=>{F(s)},$=s=>{a.value=s,d.value&&(l("update:startDate",s),l("update",{startDate:a.value,endDate:t.endDate}))},F=A.debounce($,1e3),x=s=>{Y(s)},R=s=>{r.value=s,d.value&&(l("update:endDate",s),l("update",{startDate:t.startDate,endDate:r.value}))},Y=A.debounce(R,1e3),I=s=>{switch(u.value=s,s){case e.None:return;case e.PastHours:a.value=`now - ${n.value}h`,r.value="now";break;case e.PastDays:a.value=`now - ${n.value}d`,r.value="now";break;case e.PastWeeks:a.value=`now - ${n.value}w`,r.value="now";break;case e.PastMonths:a.value=`now - ${n.value}M`,r.value="now";break;case e.PastYears:a.value=`now - ${n.value}y`,r.value="now";break;case e.CurrentHour:a.value="now/h",r.value="now";break;case e.CurrentDay:a.value="now/d",r.value="now";break;case e.CurrentWeek:a.value="now/w",r.value="now";break;case e.CurrentMonth:a.value="now/M",r.value="now";break;case e.CurrentYear:a.value="now/y",r.value="now";break;case e.LastDay:a.value="now - 1d/d",r.value="now/d";break;case e.LastWeek:a.value="now - 1w/w",r.value="now/w";break;case e.LastMonth:a.value="now - 1M/M",r.value="now/M";break;case e.LastYear:a.value="now - 1y/y",r.value="now/y";break;case e.SinceLastDay:a.value="now - 1d/d",r.value="now";break;case e.SinceLastWeek:a.value="now - 1w/w",r.value="now";break;case e.SinceLastMonth:a.value="now - 1M/M",r.value="now";break;case e.SinceLastYear:a.value="now - 1y/y",r.value="now";break;case e.LastPeriod:a.value="from - to + from",r.value="from";break;case e.MinutesBeforeAfter:a.value=`alertstart - ${n.value}m`,r.value=`alertend + ${n.value}m`;break;case e.HoursBeforeAfter:a.value=`alertstart - ${n.value}h`,r.value=`alertend + ${n.value}h`;break;case e.DaysBeforeAfter:a.value=`alertstart - ${n.value}d`,r.value=`alertend + ${n.value}d`;break;case e.WeeksBeforeAfter:a.value=`alertstart - ${n.value}w`,r.value=`alertend + ${n.value}w`;break;case e.MinutesBefore:a.value=`alertstart - ${n.value}m`,r.value="alertend";break;case e.HoursBefore:a.value=`alertstart - ${n.value}h`,r.value="alertend";break;case e.DaysBefore:a.value=`alertstart - ${n.value}d`,r.value="alertend";break;case e.WeeksBefore:a.value=`alertstart - ${n.value}w`,r.value="alertend";break;case e.Expression:t.variant==="before-after"?(a.value=`alertstart - ${n.value}d`,r.value="alertend"):(a.value=`now - ${n.value}d`,r.value="now");break;case e.Pick:r.value=p(),a.value=m();break}l("update:startDate",a.value),l("update:endDate",r.value),l("update",{startDate:a.value,endDate:r.value})},U=s=>{switch(n.value=s||1,u.value){case e.None:return;case e.PastHours:a.value=`now - ${n.value}h`,r.value="now";break;case e.PastDays:a.value=`now - ${n.value}d`,r.value="now";break;case e.PastWeeks:a.value=`now - ${n.value}w`,r.value="now";break;case e.PastMonths:a.value=`now - ${n.value}M`,r.value="now";break;case e.PastYears:a.value=`now - ${n.value}y`,r.value="now";break;case e.MinutesBeforeAfter:a.value=`alertstart - ${n.value}m`,r.value=`alertend + ${n.value}m`;break;case e.HoursBeforeAfter:a.value=`alertstart - ${n.value}h`,r.value=`alertend + ${n.value}h`;break;case e.DaysBeforeAfter:a.value=`alertstart - ${n.value}d`,r.value=`alertend + ${n.value}d`;break;case e.WeeksBeforeAfter:a.value=`alertstart - ${n.value}w`,r.value=`alertend + ${n.value}w`;break;case e.MinutesBefore:a.value=`alertstart - ${n.value}m`,r.value="alertend";break;case e.HoursBefore:a.value=`alertstart - ${n.value}h`,r.value="alertend";break;case e.DaysBefore:a.value=`alertstart - ${n.value}d`,r.value="alertend";break;case e.WeeksBefore:a.value=`alertstart - ${n.value}w`,r.value="alertend";break}l("update:startDate",a.value),l("update:endDate",r.value),l("update",{startDate:a.value,endDate:r.value})},O=s=>{s?(s&&s[0]!=null&&c(s[0])!==a.value&&(a.value=c(s[0]),d.value&&(l("update:startDate",a.value),l("update",{startDate:a.value,endDate:t.endDate}))),s&&s[1]!=null&&c(s[1])!==r.value&&(r.value=c(s[1]),d.value&&(l("update:endDate",r.value),l("update",{startDate:t.startDate,endDate:r.value})))):(r.value=p(),a.value=m(),d.value&&(l("update:startDate",a.value),l("update:endDate",r.value),l("update",{startDate:a.value,endDate:r.value})))},H=()=>{if(a.value=t.startDate,r.value=t.endDate,t.variant==="before-after"){if(t.endDate==="alertend"){let s=/^alertstart-([\d]+)([mhdw])$/g.exec(t.startDate.replaceAll(" ",""));if(s!=null)switch(n.value=parseInt(s[1]),s[2]){case"m":{u.value=e.MinutesBefore;return}case"h":{u.value=e.HoursBefore;return}case"d":{u.value=e.DaysBefore;return}case"w":{u.value=e.WeeksBefore;return}default:{u.value=e.Expression,n.value=1;return}}}if(/^alertstart-([\d]+)([mhdw])$/g.test(t.startDate.replaceAll(" ",""))&&/^alertend\+([\d]+)([mhdw])$/g.test(t.endDate.replaceAll(" ",""))){let s=/^alertstart-([\d]+)([mhdw])$/g.exec(t.startDate.replaceAll(" ","")),y=/^alertend\+([\d]+)([mhdw])$/g.exec(t.endDate.replaceAll(" ",""));if(s!=null&&y!=null&&s[1]===y[1]&&s[2]===y[2])switch(n.value=parseInt(s[1]),s[2]){case"m":{u.value=e.MinutesBeforeAfter;return}case"h":{u.value=e.HoursBeforeAfter;return}case"d":{u.value=e.DaysBeforeAfter;return}case"w":{u.value=e.WeeksBeforeAfter;return}default:{u.value=e.Expression,n.value=1;return}}}u.value=e.Expression,n.value=1;return}if(t.lastPeriod&&t.endDate==="from"&&t.startDate==="from - to + from"){u.value=e.LastPeriod;return}if(t.endDate==="now/d"&&t.startDate==="now - 1d/d"){u.value=e.LastDay;return}if(t.endDate==="now/w"&&t.startDate==="now - 1w/w"){u.value=e.LastWeek;return}if(t.endDate==="now/M"&&t.startDate==="now - 1M/M"){u.value=e.LastMonth;return}if(t.endDate==="now/y"&&t.startDate==="now - 1y/y"){u.value=e.LastYear;return}if(t.endDate==="now"){let s=/^now-1([dwMy])\/([dwMy])$/g.exec(t.startDate.replaceAll(" ",""));if(s!=null)switch(n.value=1,s[1]){case"d":{u.value=e.SinceLastDay;return}case"w":{u.value=e.SinceLastWeek;return}case"M":{u.value=e.SinceLastMonth;return}case"y":{u.value=e.SinceLastYear;return}default:{u.value=e.Expression;return}}if(s=/^now-([\d]+)([hdwMy])$/g.exec(t.startDate.replaceAll(" ","")),s!=null)switch(n.value=parseInt(s[1]),s[2]){case"h":{u.value=e.PastHours;return}case"d":{u.value=e.PastDays;return}case"w":{u.value=e.PastWeeks;return}case"M":{u.value=e.PastMonths;return}case"y":{u.value=e.PastYears;return}default:{u.value=e.Expression,n.value=1;return}}if(s=/^now\/([hdwMy])$/g.exec(t.startDate.replaceAll(" ","")),s!=null)switch(n.value=1,s[1]){case"h":{u.value=e.CurrentHour;return}case"d":{u.value=e.CurrentDay;return}case"w":{u.value=e.CurrentWeek;return}case"M":{u.value=e.CurrentMonth;return}case"y":{u.value=e.CurrentYear;return}default:{u.value=e.Expression;return}}}if(t.endDate&&v(t.endDate)!=null&&t.startDate&&v(t.startDate)!=null){u.value=e.Pick,n.value=1;return}u.value=e.Expression,n.value=1};return X([()=>t.startDate,()=>t.endDate],()=>{(t.startDate!==a.value||t.endDate!==r.value)&&H()}),Z(()=>{H()}),{innerDateSetting:u,innerDateValue:n,innerStartDate:a,innerEndDate:r,actualValue:f,pastSettings:o,DateSetting:e,NumberRules:se,DateRules:ne,TextRules:le,messages:i,valid:d,innerDateSettingChange:I,innerDateValueChange:U,innerStartDateChange:w,innerEndDateChange:x,parseForPicker:v,onPickDates:O}}});function ie(t,l,v,c,p,m){const b=g("FSSelectDateSetting"),u=g("FSNumberField"),n=g("FSDateTimeRangeField"),a=g("FSForm"),r=g("FSBaseField");return S(),P(r,{description:t.$props.description,hideHeader:t.$props.hideHeader,required:t.$props.required,disabled:t.$props.disabled,label:t.$props.label,messages:t.messages},{default:h(()=>[D(a,{modelValue:t.valid,"onUpdate:modelValue":l[0]||(l[0]=d=>t.valid=d)},{default:h(()=>[D(M,{wrap:!1},{default:h(()=>[D(b,{minWidth:"180px",lastPeriod:t.$props.lastPeriod,disabled:t.$props.disabled,variant:t.$props.variant,hideHeader:!0,modelValue:t.innerDateSetting,"onUpdate:modelValue":t.innerDateSettingChange},null,8,["lastPeriod","disabled","variant","modelValue","onUpdate:modelValue"]),t.pastSettings.includes(t.innerDateSetting)?(S(),P(u,{key:0,minWidth:"60px",rules:[t.NumberRules.required(),t.NumberRules.min(0)],disabled:t.$props.disabled,hideHeader:!0,clearable:!1,modelValue:t.innerDateValue,"onUpdate:modelValue":t.innerDateValueChange},null,8,["rules","disabled","modelValue","onUpdate:modelValue"])):t.innerDateSetting===t.DateSetting.Expression?(S(),j(K,{key:1},[D(M,{align:"center-left",wrap:!1},{default:h(()=>[D(q,null,{default:h(()=>[L(" mdi-clock-start ")]),_:1}),D(B,{rules:[t.TextRules.required(),t.DateRules.validateExpression(t.$props.variant)],disabled:t.$props.disabled,hideHeader:!0,clearable:!1,modelValue:t.innerStartDate,"onUpdate:modelValue":t.innerStartDateChange},null,8,["rules","disabled","modelValue","onUpdate:modelValue"])]),_:1}),D(M,{align:"center-left",wrap:!1},{default:h(()=>[D(q,null,{default:h(()=>[L(" mdi-clock-end ")]),_:1}),D(B,{rules:[t.TextRules.required(),t.DateRules.validateExpression(t.$props.variant)],disabled:t.$props.disabled,hideHeader:!0,clearable:!1,modelValue:t.innerEndDate,"onUpdate:modelValue":t.innerEndDateChange},null,8,["rules","disabled","modelValue","onUpdate:modelValue"])]),_:1})],64)):t.innerDateSetting===t.DateSetting.Pick?(S(),P(n,{key:2,width:["350px","310px"],rules:[t.DateRules.required()],disabled:t.$props.disabled,hideHeader:!0,clearable:!1,modelValue:t.actualValue,"onUpdate:modelValue":t.onPickDates},null,8,["rules","disabled","modelValue","onUpdate:modelValue"])):J("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["description","hideHeader","required","disabled","label","messages"])}const Be=W(T,[["render",ie]]);T.__docgenInfo={displayName:"FSTermField",exportName:"default",description:"",tags:{},props:[{name:"label",type:{name:"string | null"},required:!1,defaultValue:{func:!1,value:"null"}},{name:"description",type:{name:"string | null"},required:!1,defaultValue:{func:!1,value:"null"}},{name:"startDate",type:{name:"string"},required:!0},{name:"endDate",type:{name:"string"},required:!0},{name:"variant",values:["default","before-after"],type:{name:"string"},required:!1,defaultValue:{func:!1,value:'"default"'}},{name:"hideHeader",type:{name:"boolean"},required:!1,defaultValue:{func:!1,value:"false"}},{name:"lastPeriod",type:{name:"boolean"},required:!1,defaultValue:{func:!1,value:"false"}},{name:"required",type:{name:"boolean"},required:!1,defaultValue:{func:!1,value:"false"}},{name:"rules",type:{name:"any[]"},required:!1,defaultValue:{func:!0,value:"() => []"}},{name:"messages",type:{name:"string[]"},required:!1,defaultValue:{func:!1,value:"null"}},{name:"disabled",type:{name:"boolean"},required:!1,defaultValue:{func:!1,value:"false"}}],events:[{name:"update"},{name:"update:startDate"},{name:"update:endDate"}],sourceFiles:["/home/runner/work/foundation-shared-ui/foundation-shared-ui/src/shared/foundation-shared-components/components/fields/FSTermField.vue"]};export{Be as F,Me as u};
